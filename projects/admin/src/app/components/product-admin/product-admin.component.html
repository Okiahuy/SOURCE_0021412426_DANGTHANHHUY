<div id="success-alert" class="alert alert-success" style="display:none; position: absolute; top: 20px; left: 50%; transform: translateX(-50%); z-index: 1050; width: 700px;">
    <button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button>
    <strong>Thành công! -- Sản phẩm đã được thêm thành công!</strong>
  </div>
  
  <div id="edit-alert" class="alert alert-success" style="display:none;position: absolute; top: 20px; left: 50%; transform: translateX(-50%); z-index: 1050; width: 700px;">
    <button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button>
    <strong>Thành công! -- Sản phẩm đã được sửa thành công!</strong>
  </div>
  
  <div id="del-alert" class="alert alert-success" style="display:none; position: absolute; top: 20px; left: 50%; transform: translateX(-50%); z-index: 1050; width: 700px;">
    <button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button>
    <strong>Thành công! -- Sản phẩm đã được Xóa thành công!</strong>
  </div>
  
  <div id="err" class="alert alert-danger" style="transition: ease 3s; display:none; position: absolute; top: 20px; left: 50%; transform: translateX(-50%); z-index: 1050; width: 700px;">
    <button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button>
    <strong>Lỗi! -- Không thể xóa sản phẩm!</strong>
  </div>

  <div id="err-data" class="alert alert-danger" style="transition: ease 3s; display:none; position: absolute; top: 20px; left: 50%; transform: translateX(-50%); z-index: 1050; width: 700px;">
    <button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button>
    <strong>Lỗi! -- Dữ liệu không hợp lệ!</strong>
  </div>

  <div id="err-valid" class="alert alert-warning" style="transition: ease 3s; display:none; position: absolute; top: 20px; left: 50%; transform: translateX(-50%); z-index: 1050; width: 700px;">
    <button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button>
    <strong>Lỗi! -- Vui lòng nhập đầy đủ thông tin!</strong>
  </div>


  
<h2>Danh sách sản phẩm</h2>

<div class="form-inline">
    <div class="form-group">
        <input type="text" class="form-control" id="" placeholder="Tìm kiếm . . . . ." #searchName>
    </div>
    <button type="submit" class="btn btn-primary" (click)="searchProducts(searchName.value)"><i class="fa fa-search"></i></button>
</div>
<hr>
        <a class="btn btn-success"style="padding: 5px; font-size: 15px; background: #198754; color:white;" data-toggle="modal" data-target="#addProductModal">
            <i class="bi bi-pencil"></i> THÊM SẢN PHẨM
        </a>

    <br>
    <br>
    


<div *ngIf="products.length > 0; else noProducts">
<table class="table table-hover">
    <thead class="table table-hover table-dark">
        <tr>
            <th>Mã</th>
            <th style="max-width: 150px;">Tên</th>
            <th class="table-cell">Giá</th>
            <th>Hình Ảnh</th>
            <th>Danh Mục</th>
            <th>Thương Hiệu</th>
            <th>Màu Sắc</th>
            <th>Chất Liệu</th>
            <th>Giảm Giá</th>
            <th style="max-width: 200px;">Mô tả</th>
            <th>Số lượng</th>
            <th>Lượt Thích</th>
            <th><i class="ri-settings-5-fill"></i><i class="ri-settings-5-fill"></i></th>
        </tr>
    </thead>


    <tbody>
        <tr *ngFor="let product of products; let i = index">
            <td>{{i +1}}</td>
            <td class="table-cell">{{product.name}}</td>
            <td><strong>{{ product.price | currency: 'VND':'':''}} đ</strong></td>
            <td><img [src]="'http://localhost:8081/uploads/'+ product.imageUrl" width="70" height="70"></td>
            <td><strong>{{ categories[product.categoryID] }}</strong></td> 
            <td><strong>{{ brands[product.brandID] }}</strong></td> 
            <td>{{ colors[product.colorID] }}</td> 
            <td>{{ materials[product.materialID] }}</td> 
            <td><strong>{{ (product.disPrice/(100/100)) }}</strong></td> 
            <td class="table-cell" style="max-width: 200px;"><strong>{{ product.description }}</strong></td>
            <td><strong>{{ product.quantity }}</strong></td>
            <td><strong>{{ product.count }}</strong></td>
            <td>
              <a class="btn btn-sm" data-toggle="modal"
                data-target="#editProductModal" (click)="openEditModal(product)"><i class="ri-edit-2-line"></i>
              </a>
                <a class="btn btn-sm" data-toggle="modal" class="btn btn-sm" data-toggle="modal"
                data-target="#deleteProductModal" (click)="openDeleteModal(product.productID)"><i class="ri-delete-bin-7-line"></i></a>
            </td>
        </tr>
    </tbody>
</table>
</div>
<ng-template #noProducts>
    <p>Không có sản phẩm nào.</p>
</ng-template>

<!-- <form [formGroup]="productForm" (ngSubmit)="addProduct()">
  <input formControlName="name" placeholder="Tên sản phẩm" required />
  <textarea formControlName="description" placeholder="Mô tả" required></textarea>
  <input type="number" formControlName="price" placeholder="Giá" required />
  <input type="number" formControlName="quantity" placeholder="Số lượng" required />
  <input type="number" formControlName="categoryID" placeholder="ID danh mục" required />
  <input type="number" formControlName="brandID" placeholder="ID thương hiệu" required />
  <input type="number" formControlName="count" placeholder="Số lượng" required />
  <input type="file" multiple (change)="onFileSelected($event)" />
  <button type="submit">Thêm sản phẩm</button>
</form> -->

<!-- Phân trang -->
<nav aria-label="Page navigation">
    <ul class="pagination">
      <li class="page-item" [class.disabled]="currentPage === 1">
        <a class="page-link" (click)="changePage(currentPage - 1)"> &laquo; </a>
      </li>
  
      <li class="page-item" *ngFor="let page of [].constructor(totalPages); let i = index" 
          [class.active]="i + 1 === currentPage">
        <a class="page-link" (click)="changePage(i + 1)">{{ i + 1 }}</a>
      </li>
  
      <li class="page-item" [class.disabled]="currentPage === totalPages">
        <a class="page-link" (click)="changePage(currentPage + 1)"> &raquo; </a>
      </li>
    </ul>
  </nav>

  <div class="modal fade" id="addProductModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Thêm Sản Phẩm</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <form [formGroup]="productForm" (ngSubmit)="addProduct()">
            <div class="form-group">
              <label for="productName">Tên Sản Phẩm</label>
              <input type="text" class="form-control" id="productName" formControlName="name" required>
            </div>
            <div data-mdb-input-init class="form-outline mb-4">
              <label class="form-label" for="form2Example11">Chọn ảnh</label>
              <input type="file" class="form-control" multiple (change)="onFileSelected($event)" />
            </div>
            <div class="form-group">
              <label for="productDescription">Mô Tả</label>
              <textarea class="form-control" id="productDescription" formControlName="description" required></textarea>
            </div>
            <div class="form-group">
              <label for="productPrice">Giá</label>
              <input type="number" class="form-control" id="productPrice" formControlName="price" required>
            </div>
            <div class="form-group">
              <label for="disPrice">Giảm giá</label>
              <input type="number" class="form-control" id="disPrice" formControlName="disPrice" required>
            </div>
            <div class="form-group">
              <label for="productQuantity">Số Lượng</label>
              <input type="number" class="form-control" id="productQuantity" formControlName="quantity" required>
            </div>
            <div class="form-group">
                <label for="productCategory">Danh Mục</label>
                <select class="form-control" id="productCategory" formControlName="categoryID" required>
                  <option value="">Chọn danh mục</option>
                  <option *ngFor="let category of cate" [value]="category.categoryID">{{ category.name }}</option>
                </select>
              </div>
              <div class="form-group">
                <label for="productBrand">Thương Hiệu</label>
                <select class="form-control" id="productBrand" formControlName="brandID" required>
                  <option value="">Chọn Thương hiệu</option>
                  <option *ngFor="let brand of bra" [value]="brand.brandID">{{ brand.name }}</option>
                </select>
              </div>
              <div class="form-group">
                <label for="colorID">Màu Sắc</label>
                <select class="form-control" id="colorID" formControlName="colorID" required>
                  <option value="">Chọn Màu Sắc</option>
                  <option *ngFor="let color of col" [value]="color.colorID">{{ color.colorName }}</option>
                </select>
              </div>
              <div class="form-group">
                <label for="materialID">Chất Liệu</label>
                <select class="form-control" id="materialID" formControlName="materialID" required>
                  <option value="">Chọn Chất Liệu</option>
                  <option *ngFor="let material of mate" [value]="material.materialID">{{ material.materialName }}</option>
                </select>
              </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Đóng</button>
                <button type="submit" class="btn btn-primary pull-right" [disabled]="!productForm.valid">Lưu</button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>


  <!-- Modal Sửa Sản Phẩm -->
 <div class="modal fade" id="editProductModal" tabindex="-1" role="dialog" aria-labelledby="editProductModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h2 class="modal-title" id="editProductModalLabel">Sửa Sản Phẩm</h2>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <form [formGroup]="editProductForm" (ngSubmit)="updateProduct()">
            <div class="form-group">
              <label for="editProductName">Tên Sản Phẩm</label>
              <input type="text" class="form-control" id="editProductName" formControlName="name" required>
            </div>
            <div class="form-group">
              <label for="editProductPrice">Giá</label>
              <input type="number" class="form-control" id="editProductPrice" formControlName="price" required>
            </div>
            <div class="form-group">
              <label for="disPrice">Giảm giá</label>
              <input type="number" class="form-control" id="disPrice" formControlName="disPrice" required>
            </div>
            <div class="form-group">
              <label for="editProductQuantity">Số Lượng</label>
              <input type="number" class="form-control" id="editProductQuantity" formControlName="quantity" required>
            </div>
            <div class="form-group">
              <label for="editProductDescription">Mô Tả</label>
              <textarea class="form-control" id="editProductDescription" formControlName="description" required></textarea>
            </div>
            <div class="form-group">
              <label for="editProductCategory">Danh Mục</label>
              <select class="form-control" id="editProductCategory" formControlName="categoryID" required>
                <option *ngFor="let category of cate" [value]="category.categoryID">{{ category.name }}</option>
              </select>
            </div>
            <div class="form-group">
              <label for="editProductCategory">Thương Hiệu</label>
              <select class="form-control" id="editProductBrand" formControlName="brandID" required>
                <option *ngFor="let brand of bra" [value]="brand.brandID">{{ brand.name }}</option>
              </select>
            </div>
            <div class="form-group">
              <label for="colorID">Màu Sắc</label>
              <select class="form-control" id="colorID" formControlName="colorID" required>
                <option value="">Chọn Màu Sắc</option>
                <option *ngFor="let color of col" [value]="color.colorID">{{ color.colorName }}</option>
              </select>
            </div>
            <div class="form-group">
              <label for="materialID">Chất Liệu</label>
              <select class="form-control" id="materialID" formControlName="materialID" required>
                <option value="">Chọn Chất Liệu</option>
                <option *ngFor="let material of mate" [value]="material.materialID">{{ material.materialName }}</option>
              </select>
            </div>
            <div class="form-group">    
                <img [src]="'http://localhost:8081/uploads/'+ imageUrl" width="100" height="100">
                <input type="file" class="form-control" multiple (change)="onFileSelectedUpdate($event)"/>
          </div>
            <!-- <input type="number" hidden="true" class="form-control" id="productproductID" formControlName="productID"> -->
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Đóng</button>
                <button type="submit" class="btn btn-success pull-right">Lưu</button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div> 
  <!-- Modal Xóa Sản Phẩm -->
<div class="modal fade" id="deleteProductModal" tabindex="-1" role="dialog" aria-labelledby="deleteProductModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h2 class="modal-title" id="deleteProductModalLabel">Xóa Sản Phẩm</h2>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <p>Bạn có chắc chắn muốn xóa sản phẩm này không?</p>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-dismiss="modal">Hủy</button>
          <button type="button" class="btn btn-danger pull-right" (click)="idToDelete !== null ? deleteProduct(idToDelete) : null" data-dismiss="modal">Xóa</button>
        </div>
      </div>
    </div>
  </div>

